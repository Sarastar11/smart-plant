<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø§Ø³Ø¨Ø© ÙƒÙ…ÙŠØ© Ù…ÙŠØ§Ù‡ Ø§Ù„Ø±ÙŠ ğŸ’§</title>
<style>
body {
  height: 100%;
  margin: 0;
  padding-top: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f3f6f4;
  background-image: url(./download.webp);
  background-repeat: no-repeat;
  background-size: cover;
  font-family: "Segoe UI", sans-serif;
}

form {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  width: 300px;
  text-align: right;
}

input, select, button {
  margin: 8px 0;
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #ccc;
  text-align: right;
}

button {
  background: #2a7b3f;
  color: white;
  cursor: pointer;
  text-align: center;
  font-weight: bold;
}

button:hover {
  background: #256c39;
}

#alert {
  text-align: center;
  font-weight: bold;
  margin-top: 10px;
}
</style>
</head>
<body>
 
<form id="waterForm">
  <h2 style="text-align: center;">ğŸŒ¿ Ø§Ù„ÙÙ„Ø§Ø­ Ø§Ù„Ø°ÙƒÙŠ</h2>
  
  <label>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© (Â°C)</label>
  <input type="number" id="temp" required>

  <label>Ø§Ù„Ø±Ø·ÙˆØ¨Ø© (%)</label>
  <input type="number" id="humidity" required>

  <label>Ø±Ø·ÙˆØ¨Ø© Ø§Ù„ØªØ±Ø¨Ø© (%)</label>
  <input type="number" id="soil" required>

  <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„</label>
  <select id="crop">
    <option value="Tomato">Ø·Ù…Ø§Ø·Ù…</option>
    <option value="Wheat">Ù‚Ù…Ø­</option>
    <option value="Corn">Ø°Ø±Ø©</option>
    <option value="Cucumber">Ø®ÙŠØ§Ø±</option>
  </select>

  <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…Â²)</label>
  <input type="number" id="area" required>

  <button type="submit">Ø§Ø­Ø³Ø¨ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø§Ø¡</button>
  <p id="result"></p>

  <hr>
  <button type="button" id="pumpOn">ğŸš° Ø´ØºÙ‘Ù„ Ø§Ù„Ù…Ø¶Ø®Ø©</button>
  <button type="button" id="pumpOff">ğŸ›‘ Ø£ÙˆÙ‚Ù Ø§Ù„Ù…Ø¶Ø®Ø©</button>
  <p id="alert"></p>
</form>

<script>
  // Ø­Ø³Ø§Ø¨ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ÙŠØ§Ù‡
  document.getElementById("waterForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const body = {
      temperature: +document.getElementById("temp").value,
      humidity: +document.getElementById("humidity").value,
      soil: +document.getElementById("soil").value,
      crop: document.getElementById("crop").value,
      area: +document.getElementById("area").value
    };

    document.getElementById("result").textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...";
    try {
      const res = await fetch("http://localhost:3000/calculate-water", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });
      const data = await res.json();
      if (data.water_needed) {
        document.getElementById("result").textContent = `ğŸ’§ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ${data.water_needed.toFixed(2)} Ù„ØªØ±`;
      } else {
        document.getElementById("result").textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….";
      }
    } catch (err) {
      document.getElementById("result").textContent = "âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….";
      console.error(err);
    }
  });

  // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©
  document.getElementById("pumpOn").addEventListener("click", async () => {
    document.getElementById("alert").textContent = "â³ Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©...";
    try {
      const res = await fetch("http://localhost:3000/pump/on", { method: "POST" });
      const data = await res.json();
      document.getElementById("alert").textContent = "âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø© Ø¨Ù†Ø¬Ø§Ø­!";
    } catch (err) {
      document.getElementById("alert").textContent = "âš ï¸ ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¶Ø®Ø©.";
    }
  });

  // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©
  document.getElementById("pumpOff").addEventListener("click", async () => {
    document.getElementById("alert").textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©...";
    try {
      const res = await fetch("http://localhost:3000/pump/off", { method: "POST" });
      const data = await res.json();
      document.getElementById("alert").textContent = "ğŸš« ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©.";
    } catch (err) {
      document.getElementById("alert").textContent = "âš ï¸ ÙØ´Ù„ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¶Ø®Ø©.";
    }
  });
</script>
</body>
</html>
